import{Controller}from"@hotwired/stimulus";import*as Ajax from"ajax";export default class extends Controller{static targets=["name","output","email","emailError","firstName","saveButton"];static values={accountId:Number,firstNameCorrect:Boolean,emailCorrect:Boolean,redirectAfterSignUp:Boolean};connect(){this.firstNameTarget.addEventListener("focusout",(e=>{this.checkIfNameIsPresent()})),this.emailTarget.addEventListener("focusout",(e=>{this.checkIfEmailIsTaken()}))}disconnect(){}signup(){console.log("signup");var e=this;(new Ajax.ajax).usersSignUp(this.accountIdValue,this.emailTarget.value,this.firstNameTarget.value).then((a=>{console.log(a),"success"==a.status?e.redirectAfterSignUpValue?window.location.href="/users/successfully_signed_in":(e.showTarget(e.outputTarget),e.hideTarget(this.saveButtonTarget)):console.log("ERROR!")}))}mainCheck(){console.log("maincheck"),this.emailCorrectValue&&this.firstNameCorrectValue?this.saveButtonTarget.disabled=!1:this.saveButtonTarget.disabled=!0}changeBackgroundOfTarget(e,a){e.style.background=a}disableButton(e,a){e.disabled=a}showTarget(e){e.style.display="block"}hideTarget(e){e.style.display="none"}checkIfNameIsPresent(){var e=this;this.firstNameTarget.value.length>0?(e.changeBackgroundOfTarget(e.firstNameTarget,"lightGreen"),e.firstNameCorrectValue=!0,e.mainCheck()):(e.changeBackgroundOfTarget(e.firstNameTarget,"pink"),e.firstNameCorrectValue=!1,e.mainCheck())}checkIfEmailIsTaken(){var e=this;(new Ajax.ajax).usersCheckIfEmailIsTaken(this.emailTarget.value).then((a=>{a?(e.changeBackgroundOfTarget(e.emailTarget,"pink"),e.showTarget(e.emailErrorTarget),e.emailCorrectValue=!1,e.mainCheck()):(e.changeBackgroundOfTarget(e.emailTarget,"lightGreen"),e.hideTarget(e.emailErrorTarget),e.emailCorrectValue=!0,e.mainCheck())}))}greet(){this.outputTarget.textContent=`Hello, ${this.nameTarget.value}!`}}
