import{Controller}from"@hotwired/stimulus";import*as Ajax from"ajax";var slider,ajax;export default class extends Controller{static targets=["slide","name","exercise","output","accountId","courseId","slideId","slideSort","nextSlideId","previousSlideId","navigationButtons","currentSlide","total_slides_count","prev_button","next_button","loader","keenSlider","testicus"];static values={accountId:Number,courseId:Number,slideId:Number,slideSort:Number,urlWithoutSort:String};connect(){console.log("accountIdValue"),console.log(this.accountIdValue),ajax=new Ajax.ajax;var e=this;import("jquery_with_setup").then((t=>{import("keen-slider").then((t=>{ajax.updateCourseHistoryOfAccount(this.accountIdValue,this.courseIdValue,this.slideIdValue),slider=new KeenSlider("#my-keen-slider",{initial:parseInt(e.slideSortValue),created(){console.log("keen slider created"),$(e.keenSliderTarget).css("visibility","visible"),e.loaderTarget.textContent=""},slideChanged(){e.slideSortValue=slider.track.details.rel,e.currentSlideTarget.textContent=slider.track.details.rel+1;var t=$(slider.slides[slider.track.details.rel]).find(".slide").attr("data-value");ajax.updateCourseHistoryOfAccount(e.accountIdValue,e.courseIdValue,t),"true"===$(slider.slides[slider.track.details.rel]).find(".slide").attr("data-complete_course")&&(console.log("course completed"),ajax.updateCourseStatusOfAccount(e.accountIdValue,e.courseIdValue,"completed")),e.updateNavigationButtons(),e.updateUrl(),e.adjustHeightofSlide()}}),this.waitForVariableToBeDefined(slider,e.adjustHeightofSlide)}))})),document.addEventListener("keydown",(e=>{"ArrowRight"==e.code?this.next():"ArrowLeft"==e.code&&this.prev()}),!1)}adjustHeightofSlide(){var e=$(slider.slides[slider.track.details.rel]).find(".container").first().height();e<.333*$(window).height()&&(e=.333*$(window).height()),slider.container.style.height=e+10+"px"}updateNavigationButtons(){slider.track.details.rel-1<0?this.prev_buttonTarget.classList.add("disabled"):this.prev_buttonTarget.classList.remove("disabled"),slider.track.details.rel+1>slider.track.details.max?this.next_buttonTarget.classList.add("disabled"):this.next_buttonTarget.classList.remove("disabled")}updateUrl(){const e=this.urlWithoutSortValue+"/"+this.slideSortValue;window.history.replaceState({additionalInformation:"Updated the URL with JS"},null,e)}prev(){slider.prev()}next(){slider.next()}waitForVariableToBeDefined(e,t){void 0!==e?(console.log("defined!"),setTimeout((()=>{t()}),200)):setTimeout(waitForVariableToBeDefined,250)}greet(){this.outputTarget.textContent=`Hello, ${this.nameTarget.value}!`}}
