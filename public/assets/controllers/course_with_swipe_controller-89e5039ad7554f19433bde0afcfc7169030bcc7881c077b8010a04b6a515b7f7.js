import{Controller}from"@hotwired/stimulus";import*as Ajax from"ajax";var slider,ajax,slider_options;export default class extends Controller{static targets=["slide","name","exercise","output","accountId","courseId","slideId","slideSort","nextSlideId","previousSlideId","navigationButtons","currentSlide","total_slides_count","prev_button","next_button","loader","keenSlider","testicus"];static values={accountId:Number,courseId:Number,slideId:Number,slideSort:Number,urlWithoutSort:String};connect(){ajax=new Ajax.ajax;var e=this;import("jquery_with_setup").then((()=>{import("keen-slider").then((()=>{ajax.updateCourseHistoryOfAccount(this.accountIdValue,this.courseIdValue,this.slideIdValue),slider_options={initial:parseInt(e.slideSortValue),drag:!0,created(){$(e.keenSliderTarget).css("visibility","visible"),e.loaderTarget.textContent=""},slideChanged(){e.slideSortValue=slider.track.details.rel,e.currentSlideTarget.textContent=slider.track.details.rel+1;var t=$(slider.slides[slider.track.details.rel]).find(".slide").attr("data-value");ajax.updateCourseHistoryOfAccount(e.accountIdValue,e.courseIdValue,t),"true"===$(slider.slides[slider.track.details.rel]).find(".slide").attr("data-complete_course")&&(console.log("course completed"),ajax.updateCourseStatusOfAccount(e.accountIdValue,e.courseIdValue,"completed")),e.updateNavigationButtons(),e.updateUrl(),e.adjustHeightofSlide(),"yes"===$(slider.slides[slider.track.details.rel]).find(".slide").attr("data-disable_drag")?e.updateSlider(!1):e.updateSlider(!0)}},slider=new KeenSlider("#my-keen-slider",slider_options),this.waitForVariableToBeDefined(slider,e.adjustHeightofSlide)}))})),document.addEventListener("keydown",(e=>{"ArrowRight"==e.code?this.next():"ArrowLeft"==e.code&&this.prev()}),!1)}adjustHeightofSlide(){var e=$(slider.slides[slider.track.details.rel]).find(".container").first().height();e<.333*$(window).height()&&(e=.333*$(window).height()),slider.container.style.height=e+10+"px"}updateNavigationButtons(){slider.track.details.rel-1<0?this.prev_buttonTarget.classList.add("disabled"):this.prev_buttonTarget.classList.remove("disabled"),slider.track.details.rel+1>slider.track.details.max?this.next_buttonTarget.classList.add("disabled"):this.next_buttonTarget.classList.remove("disabled")}updateUrl(){const e=this.urlWithoutSortValue+"/"+this.slideSortValue,t={additionalInformation:"Updated the URL with JS"};window.history.replaceState(t,null,e)}updateSlider(e){setTimeout((function(){console.log("boom"),console.log("disable_drag yes"),slider_options.drag==!e&&(slider_options.drag=e,slider.update(slider_options))}),300)}prev(){slider.prev()}next(){slider.next()}waitForVariableToBeDefined(e,t){void 0!==e?(console.log("defined!"),setTimeout((()=>{t()}),200)):setTimeout(waitForVariableToBeDefined,250)}greet(){this.outputTarget.textContent=`Hello, ${this.nameTarget.value}!`}}